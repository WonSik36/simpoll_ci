(this.webpackJsonpsimpoll_dashboard=this.webpackJsonpsimpoll_dashboard||[]).push([[0],{184:function(e,t,a){},185:function(e,t,a){},186:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(37),o=a.n(s),r=(a(85),a(6)),l=a(7),c=a(9),u=a(8),h=a(11),p=a(10),m=a(190),d=a(191),b=a(74),v=a(194),f=(a(86),function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(v.a,{bg:"primary",variant:"dark"},i.a.createElement(v.a.Brand,{href:this.props.href},this.props.children),i.a.createElement(v.a.Toggle,null),i.a.createElement(v.a.Collapse,{className:"justify-content-end"},i.a.createElement(v.a.Text,null,"Signed in as:",i.a.createElement("p",{className:"nav-user"},this.props.user.nickname))))}}]),t}(i.a.Component)),g=a(196),j=a(195),y=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.data!==this.props.data}},{key:"render",value:function(){return console.log("alert box updated"),i.a.createElement(g.a,null,i.a.createElement(g.a.Header,null,"\uc54c\ub9bc"),i.a.createElement(g.a.Body,null,i.a.createElement(j.a,{variant:"danger"},i.a.createElement(j.a.Heading,null,"\uacf5\uc9c0"),"\uc54c\ub9bc \uae30\ub2a5\uc740 \ucd94\ud6c4 \uac1c\ubc1c\ub420 \uc608\uc815\uc785\ub2c8\ub2e4\u3160")))}}]),t}(i.a.Component),E=a(188),O=a(192),k=a(189),S=(a(89),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={searchType:"room",placeholder:"room\uc744 \uc785\ub825\ud558\uc138\uc694."},a.onSearchTypeChange=a.onSearchTypeChange.bind(Object(h.a)(a)),a.onSearchSubmit=a.onSearchSubmit.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.data!==this.props.data||t!==this.state}},{key:"onSearchTypeChange",value:function(e){this.setState({searchType:e.target.value,placeholder:e.target.value+"\uc744 \uc785\ub825\ud558\uc138\uc694."})}},{key:"onSearchSubmit",value:function(e){e.preventDefault(),this.props.onSubmit(e.currentTarget["search-word"].value,e.currentTarget["search-type"].value)}},{key:"render",value:function(){console.log("search box updated");var e=null;return null!==this.props.data.item.title&&(e=i.a.createElement(i.a.Fragment,null,"\uc81c\ubaa9: ",this.props.data.item.title," URL: ",this.props.data.item.url_name)),this.props.data.isLoading&&(e=i.a.createElement(E.a,{animation:"border",variant:"primary"})),i.a.createElement(g.a,null,i.a.createElement(g.a.Header,null,"\uac80\uc0c9"),i.a.createElement(g.a.Body,null,i.a.createElement(O.a,{onSubmit:this.onSearchSubmit},i.a.createElement(O.a.Control,{required:!0,type:"text",placeholder:this.state.placeholder,name:"search-word"}),i.a.createElement(O.a.Group,null,i.a.createElement(O.a.Check,{inline:!0,label:"Room",type:"radio",id:"radio-1",name:"search-type",value:"room",onChange:this.onSearchTypeChange,checked:"room"===this.state.searchType}),i.a.createElement(O.a.Check,{inline:!0,label:"Simpoll",type:"radio",id:"radio-2",name:"search-type",value:"simpoll",onChange:this.onSearchTypeChange,checked:"simpoll"===this.state.searchType}),i.a.createElement(k.a,{variant:"primary",type:"submit"},"Search!"))),i.a.createElement("div",{className:"search-box-content"},e)))}}]),t}(i.a.Component)),C=a(72),L=a(75),R=(a(184),["rgba(255, 99, 132, 0.8)","rgba(54, 162, 235, 0.8)","rgba(255, 206, 86, 0.8)","rgba(75, 192, 192, 0.8)","rgba(153, 102, 255, 0.8)","rgba(255, 159, 64, 0.8)"]),V=a(197),x=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={colors:["success","warning","danger","info","primary"]},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){if(!this.props.data.voted)return null;if(null==this.props.data.label)return null;for(var e=0,t=0;t<this.props.data.label.length;t++)e+=this.props.data.data[t];var a=[];if(0!=e)for(var n=0;n<this.props.data.label.length;n++)a.push(i.a.createElement(V.a,{animated:!0,key:n+1,variant:this.state.colors[n%this.state.colors.length],now:100*this.props.data.data[n]/e,label:this.props.data.label[n]}));return i.a.createElement(V.a,null,a)}}]),t}(i.a.Component),T=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={open:!1,choice:1},a.setOpen=a.setOpen.bind(Object(h.a)(a)),a.onChoiceChange=a.onChoiceChange.bind(Object(h.a)(a)),a.onVoteSubmit=a.onVoteSubmit.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"setOpen",value:function(e){this.setState({open:e})}},{key:"onChoiceChange",value:function(e){this.setState({choice:e.currentTarget.value})}},{key:"onVoteSubmit",value:function(e){e.preventDefault(),this.props.onVoteSubmit(e)}},{key:"render",value:function(){var e=this;console.log("vote"),console.log(this.props.data);var t=null;if(this.props.data.voted){var a={datasets:[{backgroundColor:R,data:this.props.data.data}],labels:this.props.data.label};t=i.a.createElement(L.a,{data:a})}else{for(var n=[],s=this.props.data.contents.split("|"),o=0;o<s.length;o++)n.push(i.a.createElement(O.a.Check,{key:o+1,label:s[o],type:"radio",id:"vote-"+this.props.data.sid+"-radio-1",name:"contents_number",value:o+1,onChange:this.onChoiceChange,checked:this.state.choice==o+1}));t=i.a.createElement(O.a,{onSubmit:this.onVoteSubmit},i.a.createElement(O.a.Group,null,n),i.a.createElement("input",{type:"hidden",name:"vote_id",value:this.props.data.sid}),i.a.createElement("input",{type:"hidden",name:"idx",value:this.props.idx}),i.a.createElement(k.a,{variant:"success",type:"submit"},"Submit!"))}return i.a.createElement("div",{className:"vote-container"},i.a.createElement("h5",null,this.props.data.title),i.a.createElement(x,{data:this.props.data}),i.a.createElement(k.a,{variant:"light",onClick:function(){return e.setOpen(!e.state.open)},"aria-controls":"collapse-vote-"+this.props.data.sid,"aria-expanded":this.state.open},"V"),i.a.createElement(C.a,{in:this.state.open},i.a.createElement("div",{id:"collapse-vote-"+this.props.data.sid},t)))}}]),t}(i.a.Component),_=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=[];if(this.props.data.isLoading)e=i.a.createElement(E.a,{animation:"border",variant:"primary"});else for(var t=this.props.data.items,a=0;a<t.length;a++)e.push(i.a.createElement(T,{data:t[a],key:a+1,idx:a,onVoteSubmit:this.props.onVoteSubmit}));return i.a.createElement(i.a.Fragment,null,e)}}]),t}(i.a.Component),N=a(193),w=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return console.log("room "+this.props.data.title+" is updated"),i.a.createElement(i.a.Fragment,null,i.a.createElement("h4",null,this.props.data.title),i.a.createElement("h5",null,"\ubc29\uc7a5: ",this.props.data.master_nickname),i.a.createElement("h5",null,"\ucc38\uc5ec\uc778\uc6d0: ",this.props.data.part_num,"\uba85"))}}]),t}(i.a.Component),B=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onRoomClick=a.onRoomClick.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.data!==this.props.data}},{key:"onRoomClick",value:function(e){e.preventDefault(),this.props.onRoomClick(e.currentTarget.dataset.sid)}},{key:"render",value:function(){console.log("room list is updated");var e=[];if(this.props.data.isLoading)e=i.a.createElement(E.a,{animation:"border",variant:"primary"});else for(var t=this.props.data.items,a=0;a<t.length;a++)e.push(i.a.createElement(N.a.Link,{key:a+1,href:"#room-link"+(a+1),onClick:this.onRoomClick,"data-sid":this.props.data.items[a].sid},i.a.createElement(w,{data:this.props.data.items[a],key:a+1})));return i.a.createElement(N.a,{className:"flex-column",variant:"pills",defaultActiveKey:"#room-link1"},e)}}]),t}(i.a.Component),D=(a(185),function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return console.log("Main is updated"),i.a.createElement(m.a,{className:"main-container"},i.a.createElement(d.a,null,i.a.createElement(b.a,{sm:4},i.a.createElement("h3",null,"Room"),i.a.createElement(B,{data:this.props["room-list-data"],onRoomClick:this.props.onRoomClick})),i.a.createElement(b.a,{sm:8},i.a.createElement("h3",null,"Simpoll"),i.a.createElement(_,{data:this.props["vote-list-data"],onVoteSubmit:this.props.onVoteSubmit}))))}}]),t}(i.a.Component)),U=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={user:{email:null,name:null,nickname:null},searchResult:{isLoading:!1,item:{title:null,cur_name:null}},roomList:{isLoading:!1,items:[]},voteList:{isLoading:!1,items:[]},alertList:{isLoading:!1,items:[]}},a.search=a.search.bind(Object(h.a)(a)),a.updateVoteList=a.updateVoteList.bind(Object(h.a)(a)),a.getVoteResult=a.getVoteResult.bind(Object(h.a)(a)),a.onVoteSubmit=a.onVoteSubmit.bind(Object(h.a)(a)),a.parseResponse=a.parseResponse.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){fetch("/index.php/api/user").then((function(e){return e.json()})).then(function(e){this.parseResponse(e,function(e){this.setState({user:e})}.bind(this))}.bind(this));var e=Object.assign({},this.state.roomList,{isLoading:!0});this.setState({roomList:e}),fetch("/index.php/api/find_user_rooms").then((function(e){return e.json()})).then(function(e){this.parseResponse(e,function(e){this.setState({roomList:{isLoading:!1,items:e}}),e.length>0&&this.updateVoteList(e[0].sid)}.bind(this))}.bind(this))}},{key:"search",value:function(e,t){this.setState({searchResult:{isLoading:!0,item:{}}});var a="/index.php/api/";a+="room"==t?"room_":"vote_",isNaN(e)?a+="url/":a+="page/",fetch(a+e).then((function(e){return e.json()})).then(function(e){this.parseResponse(e,function(e){this.setState({searchResult:{isLoading:!1,item:e}})}.bind(this))}.bind(this))}},{key:"updateVoteList",value:function(e){this.setState({voteList:{isLoading:!0,items:[]}}),fetch("/index.php/api/find_room_votes/"+e).then((function(e){return e.json()})).then(function(e){this.parseResponse(e,function(e){this.setState({voteList:{isLoading:!1,items:e}}),this.getVoteResult(0,!0)}.bind(this))}.bind(this))}},{key:"getVoteResult",value:function(e,t){if(!(e>=this.state.voteList.items.length))if(!1!==this.state.voteList.items[e].voted){var a=this.state.voteList.items[e].sid;fetch("/index.php/api/return_vote_result/"+a).then((function(e){return e.json()})).then(function(a){this.parseResponse(a,function(a){a.title=this.state.voteList.items[e].title,this.state.voteList.items[e]=a,this.setState({voteList:this.state.voteList}),t&&this.getVoteResult(e+1,t)}.bind(this))}.bind(this))}else this.getVoteResult(e+1,t)}},{key:"onVoteSubmit",value:function(e){var t=e.currentTarget.contents_number.value,a=e.currentTarget.vote_id.value,n=e.currentTarget.idx.value,i={contents_number:t,vote_id:a};fetch("/index.php/api/voting",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){return e.json()})).then(function(e){"success"==e.result?(this.state.voteList.items[n].voted=!0,this.getVoteResult(n,!1)):alert(e.message)}.bind(this))}},{key:"render",value:function(){return i.a.createElement(m.a,{className:"p-0"},i.a.createElement(f,{user:this.state.user,href:"/index.php/home"},"Simpoll"),i.a.createElement(d.a,{className:"m-2"},i.a.createElement(b.a,{xs:12,md:6,className:"p-1"},i.a.createElement(y,{data:this.alertList})),i.a.createElement(b.a,{xs:12,md:6,className:"p-1"},i.a.createElement(S,{onSubmit:this.search,data:this.state.searchResult}))),i.a.createElement(d.a,{className:"m-2"},i.a.createElement(D,{"room-list-data":this.state.roomList,onRoomClick:this.updateVoteList,"vote-list-data":this.state.voteList,onVoteSubmit:this.onVoteSubmit})))}},{key:"parseResponse",value:function(e,t){"success"==e.result?t(e.data):alert(e.message)}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},80:function(e,t,a){e.exports=a(186)},85:function(e,t,a){},86:function(e,t,a){},89:function(e,t,a){}},[[80,1,2]]]);
//# sourceMappingURL=main.ac663159.chunk.js.map